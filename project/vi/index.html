<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.3.0">
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R6784GJ960"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R6784GJ960');
</script>



  

  
  
  
  
  
  

  

  
  
  
    
  
  <meta name="description" content="Variational inference (VI) approximates an intractable target distribution with the closest member of a tractable family. A central challenge in black-box VI is that standard implementations, which minimize the KL divergence using stochastic gradient descent (SGD), converge slowly due to gradient noise and sensitivity to learning parameters. These issues become more pronounced when using expressive variational families, which are necessary for accurate inference in complex scientific problems.
My work shows that score matching&mdash;aligning the gradients of the log densities of the target model and variational approximation&mdash;enables faster, more reliable optimization, often yielding closed-form or convex subproblems.">

  
  <link rel="alternate" hreflang="en-us" href="https://dicai.github.io/project/vi/">

  


  

  

  

  

  

  

  
  
  
  <meta name="theme-color" content="#581845">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    

    

  

  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:400,700|Roboto:400,400italic,700|Roboto+Mono">
  

  
  
  
  <link rel="stylesheet" href="/css/academic.min.204a9ac36d21ca0c0fe5841de303d94a.css">

  

  
  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'G-R6784GJ960', 'auto');
      
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  
  

  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="https://dicai.github.io/project/vi/">

  
  
  
  
    
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@dianarycai">
  <meta property="twitter:creator" content="@dianarycai">
  
  <meta property="og:site_name" content="Diana Cai">
  <meta property="og:url" content="https://dicai.github.io/project/vi/">
  <meta property="og:title" content="Variational inference with score matching | Diana Cai">
  <meta property="og:description" content="Variational inference (VI) approximates an intractable target distribution with the closest member of a tractable family. A central challenge in black-box VI is that standard implementations, which minimize the KL divergence using stochastic gradient descent (SGD), converge slowly due to gradient noise and sensitivity to learning parameters. These issues become more pronounced when using expressive variational families, which are necessary for accurate inference in complex scientific problems.
My work shows that score matching&mdash;aligning the gradients of the log densities of the target model and variational approximation&mdash;enables faster, more reliable optimization, often yielding closed-form or convex subproblems."><meta property="og:image" content="https://dicai.github.io/project/vi/featured.jpg">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2020-09-27T00:00:00&#43;00:00">
  
  <meta property="article:modified_time" content="2020-09-27T00:00:00&#43;00:00">
  

  

  

  <title>Variational inference with score matching | Diana Cai</title>

</head>
<body id="top" data-spy="scroll" data-target="#TableOfContents" data-offset="71" >
  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">Diana Cai</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about">
            
            <span>Home</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#featured">
            
            <span>Papers</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact">
            
            <span>Contact</span>
            
          </a>
        </li>

        
        

      

        

        

        

        

      </ul>

    </div>
  </div>
</nav>


<article class="article article-project" itemscope itemtype="http://schema.org/Article">

  













<div class="article-header d-xl-none">
  <div class="featured-image" style="background-image: url('/project/vi/featured_hubb9e93d3ac7fcc9255afdd1ac3c73460_108207_800x0_resize_q95_lanczos.jpg');"></div>
  <span class="article-header-caption">Photo by rawpixel on Unsplash</span>
</div>


<div class="container-fluid split-header d-none d-xl-block">
  
    
      
        <br />
        <h1 itemprop="name" align="center">Variational inference with score matching</h1>

        

        
        

        








  








<div class="btn-links mb-3">
  
  








  










  






</div>



        
        
      
    
    
  
</div>

<div class="article-container d-xl-none">
  <h1 itemprop="name">Variational inference with score matching</h1>

  

  



<meta content="2020-09-27 00:00:00 &#43;0000 UTC" itemprop="datePublished">
<meta content="2020-09-27 00:00:00 &#43;0000 UTC" itemprop="dateModified">

<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    <time>Sep 27, 2020</time>
  </span>
  

  

  

  
  

  
  

  
    

  

</div>

  








  








<div class="btn-links mb-3">
  
  








  










  






</div>


</div>



  <div class="article-container">

    <div class="article-style" itemprop="articleBody">
      <p>Variational inference (VI) approximates an intractable <em>target</em> distribution with the closest member of a tractable  family. A central challenge in <em>black-box VI</em> is that standard implementations, which minimize the KL divergence  using stochastic gradient descent (SGD), converge slowly due to gradient noise and sensitivity to learning parameters. These issues become more pronounced when using expressive variational families, which are necessary for accurate inference in complex scientific problems.</p>
<p>My work shows that  <em>score matching</em>&mdash;aligning the gradients of the log densities of the target model and variational approximation&mdash;enables faster, more reliable optimization, often yielding closed-form or convex subproblems. We introduced Batch and Match (BaM), an iterative score-matching method for fitting full-covariance Gaussians.
BaM minimizes an objective based on a novel score matching divergence between
the variational density $q$ and the target density $p$:</p>
<!-- raw HTML omitted -->
<p>$$\mathscr{D}(q,p) = \mathbb{E}_q\left[|| \nabla \log q - \nabla \log p||^2_{\text{Cov}(q)}\right].$$</p>
<p>The BaM objective admits closed-form updates to the <em>global minimum</em> of each  subproblem.
Empirically, BaM yields 10&ndash;100x speedups over stochastic gradient-based BBVI in applications to  <em>hierarchical Bayes</em> and <em>deep generative modeling</em>.
Theoretically, we prove that for Gaussian targets, BaM converges exponentially fast to the true parameters.
To use BaM in <em>high-dimensional settings</em>, we augmented the BaM update with a  &ldquo;Patch&rdquo; operation, a structured update that projects the covariance update to a low-rank plus diagonal form  in linear time and memory.
We then demonstrated its effectiveness on high-dimensional latent Gaussian processes and other examples with dimensions up to  $8000$.</p>
<p>In many scientific domains, target distributions
exhibit skewness, heavy tails, and multimodality, which are beyond the reach of Gaussian approximations.
To address these situations,
We have  developed richer variational families that avoid the need for SGD via score matching.
The first, EigenVI,
uses <em>orthonormal basis expansions</em>, and score matching reduces inference to solving an <em>eigenvalue problem</em>,
from which EigenVI derives its name.
The second, based on  a <em>product of experts</em> (PoE),
combines multivariate-$t$ experts whose contribution is determined by a geometric weighting.
We show that this family becomes tractable using
a Feynman parameterization identity from physics.
We then developed an efficient score matching algorithm that reduces the problem to solving a sequence of <em>nonnegative least-squares problems</em>.
We characterized  <em>convergence rates</em> of this algorithm, and empirically demonstrated the effectiveness of this algorithm.</p>

    </div>

    

<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/selected/">selected</a>
  
</div>



    
    

    
    
    

    
    
    
      <h2>Publications</h2>
      
        
          
          <div class="pub-list-item" style="margin-bottom: 1rem" itemscope itemtype="http://schema.org/CreativeWork">
  <i class="far fa-file-alt pub-icon" aria-hidden="true"></i>

  
  

  <a href="/publication/conference-paper/2025-fisher-meets-feynman/" itemprop="name">Fisher meets Feynman: score-based variational inference with a product of experts</a>
  <br />
  <span itemprop="author" class="article-metadata li-cite-author"
                  style="color:#1B2631">
    



  <span itemprop="author name" itemtype="http://schema.org/Person"><b>Diana Cai</b></span>, <span itemprop="author name" itemtype="http://schema.org/Person">Robert M. Gower</span>, <span itemprop="author name" itemtype="http://schema.org/Person">David M. Blei</span>, <span itemprop="author name" itemtype="http://schema.org/Person">Lawrence K. Saul</span>

  </span>
  <br />
  <i>
  Advances in Neural Information Processing Systems (NeurIPS),
  
  </i>2025
  
  <br />
  <i style="color:gray"><b>Spotlight presentation</b>
  </i>
  

  <p>








  










  





</p>

  
</div>

        
      
        
          
          <div class="pub-list-item" style="margin-bottom: 1rem" itemscope itemtype="http://schema.org/CreativeWork">
  <i class="far fa-file-alt pub-icon" aria-hidden="true"></i>

  
  

  <a href="/publication/conference-paper/2024-patched-bam-bbvi/" itemprop="name">Batch, match, and patch: low-rank approximations for score-based variational inference</a>
  <br />
  <span itemprop="author" class="article-metadata li-cite-author"
                  style="color:#1B2631">
    



  <span itemprop="author name" itemtype="http://schema.org/Person">Chirag Modi*</span>, <span itemprop="author name" itemtype="http://schema.org/Person"><b>Diana Cai</b>*</span>, <span itemprop="author name" itemtype="http://schema.org/Person">Lawrence K. Saul</span>

  </span>
  <br />
  <i>
  Proceedings of the 28th International Conference on Artificial Intelligence and Statistics (AISTATS),
  
  </i>2025
  

  <p>








  
    
  



<a class="btn btn-outline-primary my-1 mr-1 btn-sm" href="/publication/pdfs/25-pbam.pdf" target="_blank" rel="noopener">
  PDF
</a>








  





  
  
  
    
  
  
  
  
  
    
  
  <a class="btn btn-outline-primary my-1 mr-1 btn-sm" href="https://arxiv.org/abs/2410.22292" target="_blank" rel="noopener">
    
    arXiv
  </a>

</p>

  
</div>

        
      
        
          
          <div class="pub-list-item" style="margin-bottom: 1rem" itemscope itemtype="http://schema.org/CreativeWork">
  <i class="far fa-file-alt pub-icon" aria-hidden="true"></i>

  
  

  <a href="/publication/conference-paper/2024-eigenvi-score-based-variational-inference/" itemprop="name">EigenVI: score-based variational inference with orthogonal function expansions</a>
  <br />
  <span itemprop="author" class="article-metadata li-cite-author"
                  style="color:#1B2631">
    



  <span itemprop="author name" itemtype="http://schema.org/Person"><b>Diana Cai</b></span>, <span itemprop="author name" itemtype="http://schema.org/Person">Chirag Modi</span>, <span itemprop="author name" itemtype="http://schema.org/Person">Charles C. Margossian</span>, <span itemprop="author name" itemtype="http://schema.org/Person">Robert M. Gower</span>, <span itemprop="author name" itemtype="http://schema.org/Person">David M. Blei</span>, <span itemprop="author name" itemtype="http://schema.org/Person">Lawrence K. Saul</span>

  </span>
  <br />
  <i>
  Advances in Neural Information Processing Systems (NeurIPS),
  
  </i>2024
  
  <br />
  <i style="color:gray"><b>Spotlight presentation</b>
  </i>
  

  <p>








  
    
  



<a class="btn btn-outline-primary my-1 mr-1 btn-sm" href="https://arxiv.org/pdf/2410.24054" target="_blank" rel="noopener">
  PDF
</a>








  





  
  
  
    
  
  
  
  
  
    
  
  <a class="btn btn-outline-primary my-1 mr-1 btn-sm" href="https://arxiv.org/abs/2410.24054" target="_blank" rel="noopener">
    
    arXiv
  </a>

</p>

  
</div>

        
      
        
          
          <div class="pub-list-item" style="margin-bottom: 1rem" itemscope itemtype="http://schema.org/CreativeWork">
  <i class="far fa-file-alt pub-icon" aria-hidden="true"></i>

  
  

  <a href="/publication/conference-paper/2024-batch-and-match-gaussian-bbvi/" itemprop="name">Batch and match: black-box variational inference using a score-based divergence</a>
  <br />
  <span itemprop="author" class="article-metadata li-cite-author"
                  style="color:#1B2631">
    



  <span itemprop="author name" itemtype="http://schema.org/Person"><b>Diana Cai</b></span>, <span itemprop="author name" itemtype="http://schema.org/Person">Chirag Modi</span>, <span itemprop="author name" itemtype="http://schema.org/Person">Loucas Pillaud-Vivien</span>, <span itemprop="author name" itemtype="http://schema.org/Person">Charles C. Margossian</span>, <span itemprop="author name" itemtype="http://schema.org/Person">Robert M. Gower</span>, <span itemprop="author name" itemtype="http://schema.org/Person">David M. Blei</span>, <span itemprop="author name" itemtype="http://schema.org/Person">Lawrence K. Saul</span>

  </span>
  <br />
  <i>
  Proceedings of the 41st International Conference on Machine Learning (ICML),
  
  </i>2024
  
  <br />
  <i style="color:gray"><b>Spotlight presentation</b>
  </i>
  

  <p>








  
    
  



<a class="btn btn-outline-primary my-1 mr-1 btn-sm" href="https://arxiv.org/pdf/2402.14758.pdf" target="_blank" rel="noopener">
  PDF
</a>




  
  
    
  
<a class="btn btn-outline-primary my-1 mr-1 btn-sm" href="https://github.com/modichirag/GSM-VI/" target="_blank" rel="noopener">
  Code
</a>





  





  
  
  
    
  
  
  
  
  
    
  
  <a class="btn btn-outline-primary my-1 mr-1 btn-sm" href="https://arxiv.org/abs/2402.14758" target="_blank" rel="noopener">
    
    arXiv
  </a>

  
  
  
    
  
  
  
  
  
    
  
  <a class="btn btn-outline-primary my-1 mr-1 btn-sm" href="https://openreview.net/forum?id=bplNmU2ROC" target="_blank" rel="noopener">
    
    ICML
  </a>

  
  
  
    
  
  
  
  
  
    
  
  <a class="btn btn-outline-primary my-1 mr-1 btn-sm" href="https://drive.google.com/file/d/1XsTh7k39Y05hXurFJeG2qXy1ouzyhSZE/view?usp=sharing" target="_blank" rel="noopener">
    
    Poster
  </a>

</p>

  
</div>

        
      
    

    
    
    

    








  
  
  





  
  <div class="media author-card" itemscope itemtype="http://schema.org/Person">
    

    <div class="media-body">
      <h5 class="card-title" itemprop="name"><a href="/"></a></h5>
      
      
      
      <ul class="network-icon" aria-hidden="true">
        
      </ul>
    </div>
  </div>




  </div>
</article>



<div class="container">
  <footer class="site-footer">
  

  <p class="powered-by">
    

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

</div>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    
    
    <script src="/js/mathjax-config.js"></script>
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
        
      

      
      
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_CHTML-full" integrity="sha256-GhM+5JHb6QUzOQPXSJLEWP7R73CbkisjzK5Eyij4U9w=" crossorigin="anonymous" async></script>
      
    

    
    

    
    
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    

    
    

    

    
    

    
    

    
    
    
    
    
    
    
    
    
    
    
    
    <script src="/js/academic.min.23d8e5b34c157bc6b692516f40c9395e.js"></script>

  </body>
</html>

